# 主题系统

## 一、主题系统实现逻辑

### 1.1 核心架构

主题系统采用前端本地实现方案，不依赖后端服务，主要通过以下方式实现：

#### 1.1.1 CSS变量驱动
- 使用CSS自定义属性（CSS Variables）定义所有主题相关样式
- 分别在 `light.css` 和 `dark.css` 中定义浅色和深色主题的CSS变量
- 通过 `data-theme` 属性和 `.dark` 类切换不同主题的变量值

#### 1.1.2 状态管理
- 使用 Zustand 状态管理库管理主题相关的所有状态
- 状态定义在 `appStore.ts` 中，包含主题模式、配色、布局等所有可配置项
- 提供完整的 setter 方法用于修改各项配置

#### 1.1.3 本地持久化
- 所有主题配置通过 localStorage 持久化存储
- 存储键名为 `zx-ui-app-settings`
- 页面加载时自动从 localStorage 恢复用户设置

#### 1.1.4 DOM应用层
- 使用 `useTheme` 自定义钩子将状态应用到 DOM
- 通过 `document.documentElement` 元素的 `data-theme` 属性和 `classList` 切换主题
- 动态设置 CSS 变量值，实现主题色、字体大小、圆角等配置的实时生效

### 1.2 主题切换流程

1. **用户触发切换**：通过 ThemeToggler 组件或系统设置面板触发主题切换
2. **状态更新**：调用 `setThemeMode` 更新 Zustand 状态
3. **持久化保存**：状态更新后自动保存到 localStorage
4. **DOM应用**：useTheme 钩子监听状态变化，更新 document.documentElement 的属性和类名
5. **样式生效**：CSS 根据属性和类名切换对应的变量值，页面样式实时更新

---

## 二、主题系统功能列表

### 2.1 主题风格

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 主题模式 | 切换整体主题风格 | 浅色/深色/跟随系统 | 跟随系统 |

### 2.2 菜单布局（仅后台管理）

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 菜单布局 | 后台管理页面的菜单展示方式 | 垂直/水平/混合/双列/Dock | 垂直 |

### 2.3 国际化

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 语言切换 | 界面显示语言 | 中文/English | 中文 |

### 2.4 主题配色

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 主色调 | 系统主题色，支持自定义 | 颜色选择器或预设颜色（#537BF9、#54B83E、#7E0DF5、#FF7416、#FF98C3） | #537BF9 |

### 2.5 盒子样式

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 启用边框 | 卡片和容器是否显示边框 | 开启/关闭 | 关闭 |
| 启用阴影 | 卡片和容器是否显示阴影 | 开启/关闭 | 关闭 |

### 2.6 自定义布局模式

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 多标签页 | 是否启用多标签页功能 | 开启/关闭 | 关闭 |
| 显示顶栏 | 是否显示顶部导航栏 | 开启/关闭 | 开启 |
| 面包屑导航 | 是否显示面包屑导航 | 开启/关闭 | 关闭 |
| 侧边栏手风琴 | 侧边栏菜单是否采用手风琴模式 | 开启/关闭 | 开启 |
| 允许选择文字 | 是否允许用户选择页面文字 | 开启/关闭 | 关闭 |
| 色弱模式 | 色弱友好显示模式 | 开启/关闭 | 关闭 |
| 点击动效 | 点击时是否显示火花动效 | 开启/关闭 | 开启 |

### 2.7 菜单宽度

| 功能 | 说明 | 可选范围 | 默认值 |
|------|------|----------|--------|
| 菜单宽度 | 侧边栏菜单宽度 | 160px - 300px | 220px |

### 2.8 圆角与字体

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 全局圆角 | 所有组件的圆角大小 | 0px - 24px | 12px |
| 字体大小 | 全局基础字体大小 | 12px/14px/16px/18px | 14px |
| 内容区边距 | 页面内容区域的内边距 | 8px/16px/24px | 16px |

### 2.9 页面切换动效

| 功能 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| 页面切换动效 | 页面跳转时的过渡动画 | 关闭/淡入淡出/滑入滑出/缩放渐变/层级切换 | 淡入淡出 |

### 2.10 其他功能

| 功能 | 说明 |
|------|------|
| 重置设置 | 一键恢复所有配置为默认值 |
| 平滑过渡 | 主题切换时带有平滑的过渡动画 |
| 圆形遮罩动画 | 主题切换时支持从按钮位置扩散的圆形遮罩动画 |

---

## 三、技术要点总结

1. **纯前端实现**：主题系统完全在前端实现，不依赖后端服务
2. **本地存储**：用户配置持久化到 localStorage，刷新页面后保持设置
3. **CSS变量**：使用 CSS 自定义属性实现主题切换，性能优异
4. **状态管理**：使用 Zustand 轻量级状态管理库，代码简洁高效
5. **自定义钩子**：通过 useTheme 钩子统一管理主题应用逻辑
6. **平滑过渡**：所有配置变更都带有平滑的过渡动画，用户体验良好
